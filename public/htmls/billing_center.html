<div class="container_fuild">
  <div class="row"> <!-- main row -->

    <!-- API section -->
    <div class="col-md-7">

			<!-- API title goes here -->
      <div class="row">
        <div class="col-md-3">
          <div class="corner_space"></div>
				</div>
        <div class="col-md-9">
					<h2>Billing Center</h2>
					<p class="text-muted">The Billing Center API allows you to access your websiteâ€™s monthly usage over the Akamai network.</p>
					<p class="text-muted">This guide details the most recent version 2 of the Billing Center API, which provides data in JSON format. For the deprecated version 1, which provides CSV data, see <a href="https://developer.akamai.com/api/luna/billing-usage-v1/overview.html" target="_blank">Billing Center API, v1.</a></p>
					<hr>
				</div>
			</div>

      <!-- API content main body -->
      <div class="row">

        <!-- left menu -->
        <div class="col-md-3">
          <ul class="nav nav-pills nav-stacked">
            <li><h5>Contract/Reporting Group</h5></li>
            <li role="presentation" onclick="showAPIActionContent('chk_contract_RG_ID')"><a href="#">Report Sources</a></li>
            <li role="presentation" onclick="showAPIActionContent('chk_product_ID')"><a href="#">Products</a></li>
            <li><h5>Contracts Details</h5></li>
            <li role="presentation" onclick="showAPIActionContent('statistics_per_contract')"><a href="#">Statistics unit available per Contract</a></li>
            <li role="presentation" onclick="showAPIActionContent('monthly_usage_per_contract')"><a href="#">Monthly Usage per Contract</a></li>
            <li><h5>Reporting Groups Details</h5></li>
            <li role="presentation" onclick="showAPIActionContent('statistics_per_reporting_group')"><a href="#">Statistics unit available per Reporting Group</a></li>
            <li role="presentation" onclick="showAPIActionContent('monthly_usage_per_reporting_group')"><a href="#">Monthly Usage per Reporting Group</a></li>
          </ul>
        </div>

        <!-- API action content -->
        <div class="col-md-9">
          <div id="api_action_body_wrapper">
             <div id="chk_contract_RG_ID" class="each_api_action" style="display: none">
							<label for="chk_contract_RG_ID">Report Sources</label>
							<span class="help-block">Gets all Report Sources for the user account. Report sources are used to limit the scope of returned contract usage data. There are two types of report sources, which are distinguished by the type parameter:</span>
							<p class="text-muted"> - reportGroup: a reporting group</p>
							<p class="text-muted"> - contract: a top level group (contract)</p>
              <fieldset disabled>
                <div class="form-group">
                  <input id="chk_contract_RG_ID" type="text" class="form-control" placeholder="/billing-usage/v1/reportSources">
                </div>
              </fieldset>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('chk_contract_RG_ID')">
            </div>

            <div id="chk_product_ID" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="chk_pid_contract_id">Products</label>
								<span class="help-block">Gets all products that are available for the given report source in the provided time span. Only products that have report data available for the provided arguments will be returned.</span>
                <input id="chk_pid_contract_id" type="text" class="form-control" placeholder="C-1BBSI2U (Contract ID) or (Reporting Group ID)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('chk_product_ID')">
            </div>

						<!-- statistics_per_contract -->
            <div id="statistics_per_contract" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="spc_contract_id">Contract ID</label>
                <span id="helpBlock" class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="spc_contract_id" type="text" class="form-control" placeholder="C-1BBSI2U">
              </div>
              <div class="form-group">
                <label for="spc_product_id">Product ID</label>
                <span id="helpBlock" class="help-block">Identifies the product under which data is aggregated.</span>
                <input id="spc_product_id" type="text" class="form-control" placeholder="B-3-1WYBV">
              </div>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data.</span>
								<div class="input-group input-daterange short">
									<input type="text" class="form-control spc start" value="2016-01">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control spc end" value="2016-07">
								</div>
							</div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('statistics_per_contract')">
            </div>

            <!-- monthly_usage_per_contract -->
            <div id="monthly_usage_per_contract" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="">Contract ID</label>
                <span id="helpBlock" class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="mupc_contract_id" type="text" class="form-control" placeholder="Contract ID">
              </div>
              <div class="form-group">
                <label for="">Product ID</label>
                <span id="helpBlock" class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="mupc_product_id" type="text" class="form-control" placeholder="Product ID">
              </div>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data.</span>
								<div class="input-group input-daterange short">
									<input type="text" class="form-control mupc start" value="2016-01">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control mupc end" value="2016-07">
								</div>
							</div>
              <div class="form-group">
                <label for="">Statistic Unit</label>
                <span id="helpBlock" class="help-block">Reports on a specific statistic, otherwise reports all statistics by default.</span>
                <span id="helpBlock" class="help-block">Example: Total MB, 95/5 Mbps</span>
                <input id="statisticName" type="text" class="form-control short" placeholder="Total MB">
              </div>
							<div class="form-group">
								<label for="">Billing Day Only</label>
                <span id="helpBlock" class="help-block">Aggregates cumulative data as of the end of the billing period, typically the end of the month, otherwise the day the contract's term expires. Supplementary data may be available when contracts are extended within a given month.</span>
								<select class="form-control short" id="billingDayOnly">
									<option value="true">true</option>
									<option value="false">false</option>
								</select>
							</div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('monthly_usage_per_contract')">
            </div>

            <!-- statistics_per_reporting_group -->
            <div id="statistics_per_reporting_group" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="spr_reporting_group_id">Reporting Group ID</label>
                <span id="helpBlock" class="help-block">Identifies the unique reporting group.</span>
                <input id="spr_reporting_group_id" type="text" class="form-control" placeholder="86844">
              </div>
              <div class="form-group">
                <label for="spr_product_id">Product ID</label>
                <span id="helpBlock" class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="spr_product_id" type="text" class="form-control" placeholder="B-3-1WYBV">
              </div>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data.</span>
								<div class="input-group input-daterange short">
									<input type="text" class="form-control spr start" value="2016-01">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control spr end" value="2016-07">
								</div>
							</div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('statistics_per_reporting_group')">
            </div>

            <div id="monthly_usage_per_reporting_group" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="mpr_reporting_group_id">Reporting Group ID</label>
                <span id="helpBlock" class="help-block">Identifies the unique reporting group.</span>
                <input id="mpr_reporting_group_id" type="text" class="form-control" placeholder="19144">
              </div>
              <div class="form-group">
                <label for="mpr_product_id">Product ID</label>
                <span id="helpBlock" class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="mpr_product_id" type="text" class="form-control" placeholder="B-3-1WYBV">
              </div>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data.</span>
								<div class="input-group input-daterange short">
									<input type="text" class="form-control mpr start" value="2016-01">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control mpr end" value="2016-07">
								</div>
							</div>
              <div class="form-group">
                <label for="mpr_statisticName">Statistic Unit</label>
                <span id="helpBlock" class="help-block">Reports on a specific statistic, otherwise reports all statistics by default.</span>
                <span id="helpBlock" class="help-block">Example: Total MB, 95/5 Mbps</span>
                <input id="mpr_statisticName" type="text" class="form-control" placeholder="Total MB">
              </div>
              <div class="form-group">
                <span id="helpBlock" class="help-block">Aggregates cumulative data as of the end of the billing period, typically the end of the month, otherwise the day the contract's term expires. Supplementary data may be available when contracts are extended within a given month.</span>
                <select class="form-control short" id="mpr_billingDayOnly">
                  <option value="true">true</option>
                  <option value="false">false</option>
                </select>
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('monthly_usage_per_reporting_group')">
            </div>

            <div id="api_response_wrapper" class="each_api_action top-buffer" style="display: none">
              <div id="loading_spinner" style="display: none"></div>
              <span id="api_response"></span>
            </div>

          </div> <!-- action body wrapper -->
        </div> <!-- API action content end -->
      </div> <!-- API content main body end -->

    </div> <!-- API section end -->

    <!-- Toke HTML column -->
    <div class="col-md-4 col-sm-offset-1">
      <div id="token_html"></div>
    </div>

  </div> <!-- end of main row -->
</div> <!-- container -->

<div id="footer_html"></div>

<script>
  $(document).ready(function() {
    loadTokenHtml();
    showAPIActionContent('chk_contract_RG_ID');
		$('.input-daterange input').each(function() {
			$(this).datepicker({
				format: "yyyy-mm",
				startView: "months",
				minViewMode: "months"
			});
		});
  });

  function runAPI(apitype) {

    if (apitype == "chk_contract_RG_ID") {
      var endpoint = "/billing-usage/v1/reportSources";
      sendAPIRequestGet(endpoint, "luna_token");
    }

    if (apitype == "chk_product_ID") {
      var cid = $("#chk_pid_contract_id").val();
      if (cid) {
        var type = "reportGroup";
        if (isNaN(cid)) { type = "contract"; }
        var thisyear = (new Date()).getFullYear();
        var body = 'reportSources=[{"type":"'+type+'","id":"'+ cid + '"}]';
        body += '&endDate={"month":"12","year":"'+thisyear+'"}&startDate={"month":"01","year":"'+thisyear+'"}';
        var endpoint = "/billing-usage/v1/products";
        sendAPIRequestPost(endpoint, "luna_token", body);
      } else {
        showNotification("Please enter Contract or Reporting ID");
      }
    }

    if (apitype == "statistics_per_contract") {
      var cid = $("#spc_contract_id").val();
      var pid = $("#spc_product_id").val();
      if (cid && pid) {
        var startYear = $('.input-daterange .spc.start').datepicker('getDate').getFullYear();
        var startMonth = $('.input-daterange .spc.start').datepicker('getDate').getMonth() + 1;
        var toYear = $('.input-daterange .spc.end').datepicker('getDate').getFullYear();
        var toMonth = $('.input-daterange .spc.end').datepicker('getDate').getMonth() + 1;
        var endpoint = "/billing-center-api/v2/contracts/"+cid+"/products/"+pid+"/statistics";
        endpoint += "?fromYear="+startYear+"&fromMonth="+startMonth+"&toYear="+toYear+"&toMonth="+toMonth;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Please enter Contract/Product ID");
      }
    }

    if (apitype == "monthly_usage_per_contract") {
      var cid = $("#mupc_contract_id").val();
      var pid = $("#mupc_product_id").val();
      if (cid && pid) {
        var startYear = $('.input-daterange .mupc.start').datepicker('getDate').getFullYear();
        var startMonth = $('.input-daterange .mupc.start').datepicker('getDate').getMonth() + 1;
        var toYear = $('.input-daterange .mupc.end').datepicker('getDate').getFullYear();
        var toMonth = $('.input-daterange .mupc.end').datepicker('getDate').getMonth() + 1;
				var statName = encodeURI($('#statisticName').val());
        var billingday = $('#billingDayOnly').val();
        var endpoint = "/billing-center-api/v2/contracts/"+cid+"/products/"+pid+"/measures";
        endpoint += "?fromYear="+startYear+"&fromMonth="+startMonth+"&toYear="+toYear+"&toMonth="+toMonth;
        endpoint += "&statisticName="+statName+"&billingDayOnly="+billingday;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "statistics_per_reporting_group") {
      var endpoint = "/billing-center-api/v2/reporting-groups/";
      var rgid = $("#spr_reporting_group_id").val();
      var pid = $("#spr_product_id").val();
      if (rgid && pid) {
        var startYear = $('.input-daterange .spr.start').datepicker('getDate').getFullYear();
        var startMonth = $('.input-daterange .spr.start').datepicker('getDate').getMonth() + 1;
        var toYear = $('.input-daterange .spr.end').datepicker('getDate').getFullYear();
        var toMonth = $('.input-daterange .spr.end').datepicker('getDate').getMonth() + 1;
        var endpoint = "/billing-center-api/v2/reporting-groups/"+rgid+"/products/"+pid+"/statistics";
        endpoint += "?fromYear="+startYear+"&fromMonth="+startMonth+"&toYear="+toYear+"&toMonth="+toMonth;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Please enter Reporting Group/Product ID");
      }
    }

    if (apitype == "monthly_usage_per_reporting_group") {
      var rid = $("#mpr_reporting_group_id").val();
      var pid = $("#mpr_product_id").val();
      if (rid && pid) {
        var startYear = $('.input-daterange .mpr.start').datepicker('getDate').getFullYear();
        var startMonth = $('.input-daterange .mpr.start').datepicker('getDate').getMonth() + 1;
        var toYear = $('.input-daterange .mpr.end').datepicker('getDate').getFullYear();
        var toMonth = $('.input-daterange .mpr.end').datepicker('getDate').getMonth() + 1;
        var statName = encodeURI($('#mpr_statisticName').val());
        var billingday = $('#mpr_billingDayOnly').val();
        var endpoint = "/billing-center-api/v2/reporting-groups/"+rid+"/products/"+pid+"/measures";
        endpoint += "?fromYear="+startYear+"&fromMonth="+startMonth+"&toYear="+toYear+"&toMonth="+toMonth;
        endpoint += "&statisticName="+statName+"&billingDayOnly="+billingday;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }
  }
</script>

