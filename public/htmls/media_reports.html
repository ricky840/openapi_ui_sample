<div class="container_fuild">
  <div class="row"> <!-- main row -->

    <!-- API section -->
    <div class="col-md-7">

			<!-- API title goes here -->
      <div class="row">
        <div class="col-md-3">
          <div class="corner_space"></div>
				</div>
        <div class="col-md-9">
					<h2>Media Reports API</h2>
          <p class="text-muted">Media Reports help you monitor and identify key trends of your Akamai Media Delivery solutions. Its one-stop, easy reporting interface within Luna Control Center gives you access to valuable insights to enhance your business by optimizing your streaming content, software downloads, and object delivery.</p>
					<hr>
				</div>
			</div>

      <!-- API content main body -->
      <div class="row">

        <!-- left menu -->
        <div class="col-md-3">
          <ul class="nav nav-pills nav-stacked">
            <li><h5>Download Delivery</h5></li>
            <li role="presentation" onclick="showAPIActionContent('dd_dimension')"><a href="#">Dimensions</a></li>
            <li role="presentation" onclick="showAPIActionContent('dd_metric')"><a href="#">Metrics</a></li>
            <li role="presentation" onclick="showAPIActionContent('dd_data')"><a href="#">Data</a></li>
            <li><h5>Object Delivery</h5></li>
            <li role="presentation" onclick="showAPIActionContent('od_dimension')"><a href="#">Dimensions</a></li>
            <li role="presentation" onclick="showAPIActionContent('od_metric')"><a href="#">Metrics</a></li>
            <li role="presentation" onclick="showAPIActionContent('od_data')"><a href="#">Data</a></li>
            <li><h5>Adaptive Media Delivery</h5></li>
            <li role="presentation" onclick="showAPIActionContent('amd_dimension')"><a href="#">Dimensions</a></li>
            <li role="presentation" onclick="showAPIActionContent('amd_metric')"><a href="#">Metrics</a></li>
            <li role="presentation" onclick="showAPIActionContent('amd_data')"><a href="#">Data</a></li>
          </ul>
        </div>

        <!-- API action content -->
        <div class="col-md-9">
          <div id="api_action_body_wrapper">

            <!-- Download Delivery -->
             <div id="dd_dimension" class="each_api_action" style="display: none">
							<label for="">Dimensions</label>
							<span class="help-block">Retrieves all the dimensions available for Download Delivery.</span>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runApiGetDimension('download-delivery')">
            </div>
            <div id="dd_metric" class="each_api_action" style="display: none">
							<label for="">Metrics</label>
							<span class="help-block">Retrieves all the metrics available for Download Delivery.</span>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runApiGetMetric('download-delivery')">
            </div>
            <div id="dd_data" class="each_api_action" style="display: none">
							<span class="help-block">Retrieves the data for Download Delivery according to the given parameters.</span>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data. You can only choose one month of period.</span>
								<div class="input-group input-daterange">
									<input type="text" class="form-control dd start" value="">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control dd end" value="">
                </div>
              </div>
              <div class="form-group">
                <label for="">Dimensions</label>
                <span class="help-block">The IDs of required dimensions. (Comma separated numbers)</span>
                <input id="dd_dimention_ids" type="text" class="form-control" placeholder="1 (Time)">
              </div>
              <div class="form-group">
                <label for="">Metrics</label>
                <span class="help-block">The IDs of required metrics. (Comma separated numbers)</span>
                <input id="dd_metric_ids" type="text" class="form-control" placeholder="2 (Total Bytes)">
              </div>
              <div class="form-group">
                <label for="">Cpcodes</label>
                <span class="help-block">The cpcodes for which the data is required. (Comma separated cpcodes)</span>
                <input id="dd_cpcodes" type="text" class="form-control" placeholder="478042">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('dd')">
            </div>

            <!-- Object delivery -->
             <div id="od_dimension" class="each_api_action" style="display: none">
							<label for="">Dimensions</label>
							<span class="help-block">Retrieves all the dimensions available for Object Delivery.</span>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runApiGetDimension('object-delivery')">
            </div>
            <div id="od_metric" class="each_api_action" style="display: none">
							<label for="">Metrics</label>
							<span class="help-block">Retrieves all the metrics available for Object Delivery.</span>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runApiGetMetric('object-delivery')">
            </div>
            <div id="od_data" class="each_api_action" style="display: none">
							<span class="help-block">Retrieves the data for Object Delivery according to the given parameters.</span>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data. You can only choose one month of period.</span>
								<div class="input-group input-daterange">
									<input type="text" class="form-control od start" value="">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control od end" value="">
                </div>
              </div>
              <div class="form-group">
                <label for="">Dimensions</label>
                <span class="help-block">The IDs of required dimensions. (Comma separated numbers)</span>
                <input id="od_dimention_ids" type="text" class="form-control" placeholder="1 (Time)">
              </div>
              <div class="form-group">
                <label for="">Metrics</label>
                <span class="help-block">The IDs of required metrics. (Comma separated numbers)</span>
                <input id="od_metric_ids" type="text" class="form-control" placeholder="44 (Edge Volume)">
              </div>
              <div class="form-group">
                <label for="">Cpcodes</label>
                <span class="help-block">The cpcodes for which the data is required. (Comma separated cpcodes)</span>
                <input id="od_cpcodes" type="text" class="form-control" placeholder="400439">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('od')">
            </div>

            <!-- Adaptive delivery -->
             <div id="amd_dimension" class="each_api_action" style="display: none">
							<label for="">Dimensions</label>
							<span class="help-block">Retrieves all the dimensions available for Adaptive Media Delivery.</span>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runApiGetDimension('adaptive-media-delivery')">
            </div>
            <div id="amd_metric" class="each_api_action" style="display: none">
							<label for="">Metrics</label>
							<span class="help-block">Retrieves all the metrics available for Adaptive Media Delivery.</span>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runApiGetMetric('adaptive-media-delivery')">
            </div>
            <div id="amd_data" class="each_api_action" style="display: none">
							<span class="help-block">Retrieves the data for Adaptive Media Delivery according to the given parameters.</span>
              <div class="form-group">
                <label for="">Date Range</label>
                <span id="helpBlock" class="help-block">The date range of aggregated data. You can only choose one month of period.</span>
								<div class="input-group input-daterange">
									<input type="text" class="form-control amd start" value="">
									<span class="input-group-addon">to</span>
									<input type="text" class="form-control amd end" value="">
                </div>
              </div>
              <div class="form-group">
                <label for="">Dimensions</label>
                <span class="help-block">The IDs of required dimensions. (Comma separated numbers)</span>
                <input id="amd_dimention_ids" type="text" class="form-control" placeholder="1 (Time)">
              </div>
              <div class="form-group">
                <label for="">Metrics</label>
                <span class="help-block">The IDs of required metrics. (Comma separated numbers)</span>
                <input id="amd_metric_ids" type="text" class="form-control" placeholder="2 (Total Bytes)">
              </div>
              <div class="form-group">
                <label for="">Cpcodes</label>
                <span class="help-block">The cpcodes for which the data is required. (Comma separated cpcodes)</span>
                <input id="amd_cpcodes" type="text" class="form-control" placeholder="455562">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('amd')">
            </div>

            <!-- response -->
            <div id="api_response_wrapper" class="each_api_action top-buffer" style="display: none">
              <div id="loading_spinner" style="display: none"></div>
              <span id="api_response"></span>
            </div>

          </div> <!-- action body wrapper -->
        </div> <!-- API action content end -->
      </div> <!-- API content main body end -->

    </div> <!-- API section end -->

    <!-- Toke HTML column -->
    <div class="col-md-4 col-sm-offset-1">
      <div id="token_html"></div>
    </div>

  </div> <!-- end of main row -->
</div> <!-- container -->

<div id="footer_html"></div>

<script>
  $(document).ready(function() {
    loadTokenHtml();
    showAPIActionContent('dd_dimension');
    $('.input-daterange input').each(function() {
      $(this).datepicker({
        startDate: '-1m',
        endDate: '+0d',
        autoclose: true
      });
      $(this).datepicker('setDate', getFormattedDate(new Date()));
    });
  });

  function runApiGetDimension(product) {
    var endpoint = "/media-reports/v1/"+product+"/dimensions";
    sendAPIRequestGet(endpoint, "luna_token");
  }

  function runApiGetMetric(product) {
    var endpoint = "/media-reports/v1/"+product+"/metrics";
    sendAPIRequestGet(endpoint, "luna_token");
  }

  function runAPI(apitype) {
    if (apitype == "dd") {
      var dids = $("#dd_dimention_ids").val();
      var mids = $("#dd_metric_ids").val();
      var cpcodes = $("#dd_cpcodes").val();
      var start_date = getFormattedDate($('.input-daterange .dd.start').datepicker('getDate'));
      var end_date = getFormattedDate($('.input-daterange .dd.end').datepicker('getDate'));
      if (dids && mids && cpcodes && start_date && end_date) {
        var endpoint = "/media-reports/v1/download-delivery/data?";
        query = "startDate="+start_date+"&endDate="+end_date+"&dimensions="+dids;
        query += "&metrics="+mids+"&cpcodes="+cpcodes;
				endpoint += encodeURI(query);
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "od") {
      var dids = $("#od_dimention_ids").val();
      var mids = $("#od_metric_ids").val();
      var cpcodes = $("#od_cpcodes").val();
      var start_date = getFormattedDate($('.input-daterange .od.start').datepicker('getDate'));
      var end_date = getFormattedDate($('.input-daterange .od.end').datepicker('getDate'));
      if (dids && mids && cpcodes && start_date && end_date) {
        var endpoint = "/media-reports/v1/object-delivery/data?";
        query = "startDate="+start_date+"&endDate="+end_date+"&dimensions="+dids;
        query += "&metrics="+mids+"&cpcodes="+cpcodes;
				endpoint += encodeURI(query);
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "amd") {
      var dids = $("#amd_dimention_ids").val();
      var mids = $("#amd_metric_ids").val();
      var cpcodes = $("#amd_cpcodes").val();
      var start_date = getFormattedDate($('.input-daterange .amd.start').datepicker('getDate'));
      var end_date = getFormattedDate($('.input-daterange .amd.end').datepicker('getDate'));
      if (dids && mids && cpcodes && start_date && end_date) {
        var endpoint = "/media-reports/v1/adaptive-media-delivery/data?";
        query = "startDate="+start_date+"&endDate="+end_date+"&dimensions="+dids;
        query += "&metrics="+mids+"&cpcodes="+cpcodes;
				endpoint += encodeURI(query);
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }
  }
</script>
