<div class="container_fuild">
  <div class="row"> <!-- main row -->

    <!-- API section -->
    <div class="col-md-7">

			<!-- API title goes here -->
      <div class="row">
        <div class="col-md-3">
          <div class="corner_space"></div>
				</div>
        <div class="col-md-9">
					<h2>Content Control Utility V3</h2>
					<p>The Content Control Utility (CCU) API allows you to purge edge content by request. You can use the API to purge by URL, with support for purge by Content Provider (CP) code coming soon. This API leverages the new Fast Purge utility.</p><p><strong>NOTE</strong>: If the account is not properly enabled for Fast Purge, the purge request is processed by the legacy (V2) version of CCU.</p>
					<hr>
				</div>
			</div>

      <!-- API content main body -->
      <div class="row">

        <!-- left menu -->
        <div class="col-md-3">
          <ul class="nav nav-pills nav-stacked">
            <li><h5>CCU APIs</h5></li>
            <li role="presentation" onclick="showAPIActionContent('invalidations')"><a href="#">Invalidations</a></li>
            <li role="presentation" onclick="showAPIActionContent('deletions')"><a href="#">Deletions</a></li>
          </ul>
        </div>

        <!-- API action content -->
        <div class="col-md-9">
          <div id="api_action_body_wrapper">

            <div id="invalidations" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="invalidations_network">Select Network</label>
                <span class="help-block">The network on which you want to invalidate the URL. You can choose either production or staging. If you do not specify a network, the operation is applied to Production.</span>
                <select class="form-control" id="invalidations_network">
                  <option value="staging">Staging</option>
                  <option value="production">Production</option>
                </select>
              </div>
              <div class="form-group">
                <label for="invalidations_body">Invalidations Object</label>
                <span class="help-block">Objects that should be purged(invalidated)</span>
                <div id="textarea_wrapper" class="form-group has-feedback">
                  <textarea id="invalidations_body" class="form-control" rows="15" placeholder="" onkeydown="validateJsonTextarea('textarea_wrapper', 'invalidations_body')"></textarea>
                </div>
              </div>
              <input class="btn btn-success" type="button" value="Validate JSON" onclick="validateJsonTextarea('textarea_wrapper', 'invalidations_body')">
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('invalidations')">
            </div>

            <div id="deletions" class="each_api_action" style="display: none">
              <div class="form-group">
                <label for="deletions_network">Select Network</label>
                <span class="help-block">The network on which you want to delete the URL. You can choose either production or staging. If you do not specify a network, the operation is applied to Production.</span>
                <select class="form-control" id="deletions_network">
                  <option value="staging">Staging</option>
                  <option value="production">Production</option>
                </select>
              </div>
              <div class="form-group">
                <label for="deletions_body">Deletions Object</label>
                <span class="help-block">Objects that should be purged(deleted)</span>
                <div id="textarea_wrapper_delete" class="form-group has-feedback">
                  <textarea id="deletions_body" class="form-control" rows="10" placeholder="" onkeydown="validateJsonTextarea('textarea_wrapper_delete', 'deletions_body')"></textarea>
                </div>
                <input class="btn btn-success" type="button" value="Validate JSON" onclick="validateJsonTextarea('textarea_wrapper_delete', 'deletions_body')">
                <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('deletions')">
              </div>
            </div>

            <div id="api_response_wrapper" class="each_api_action top-buffer" style="display: none">
              <span id="api_response"></span>
            </div>

          </div> <!-- action body wrapper -->
        </div> <!-- API action content end -->
      </div> <!-- API content main body end -->

    </div> <!-- API section end -->

    <!-- Toke HTML column -->
    <div class="col-md-4 col-sm-offset-1">
      <div id="token_html"></div>
    </div>

  </div> <!-- end of main row -->
</div> <!-- container -->

<div id="footer_html"></div>

<script>
  $(document).ready(function() {
    loadTokenHtml();
    showAPIActionContent('invalidations');
  });

  var placeholder = '{"hostname": "ic-clean.datswatsup.com","objects": ["/graphics/picture.gif","/documents/brochure.pdf"]}';
  placeholder = JSON.stringify(JSON.parse(placeholder), null, 2);
  $("#invalidations_body").val(placeholder);
  $("#deletions_body").val(placeholder);

  function runAPI(apitype) {
    if (apitype == "invalidations") {
      var endpoint = "/ccu/v3/invalidate/url/";
      var body = $("#invalidations_body").val();
      var network = $("#invalidations_network").val();
      endpoint = endpoint + network;
      if (IsJsonString(body)) {
        var return_response = sendAPIRequestPost(endpoint, "ccu_token", body);
        showResponse(body, return_response);
      } else {
        showNotification("JSON is not in valid format");
      }
    }

    if (apitype == "deletions") {
      var endpoint = "/ccu/v3/delete/url/";
      var body = $("#deletions_body").val();
      var network = $("#deletions_network").val();
      endpoint = endpoint + network;
      if (IsJsonString(body)) {
        var return_response = sendAPIRequestPost(endpoint, "ccu_token", body);
        showResponse(body, return_response);
      } else {
        showNotification("JSON is not in valid format");
      }
    }
  }
</script>
