<div class="container_fuild">
  <div class="row"> <!-- main row -->

    <!-- API section -->
    <div class="col-md-7">

			<!-- API title goes here -->
      <div class="row">
        <div class="col-md-3">
          <div class="corner_space"></div>
				</div>
        <div class="col-md-9">
					<h2>The Invoicing API</h2>
          <p class="text-muted">This API allows you to access your Akamai invoices.</p>
					<hr>
				</div>
			</div>

      <!-- API content main body -->
      <div class="row">

        <!-- left menu -->
        <div class="col-md-3">
          <ul class="nav nav-pills nav-stacked">
            <li><h5>Invoices</h5></li>
            <li role="presentation" onclick="showAPIActionContent('inpacct')"><a href="#">Invoices per Account</a></li>
            <li role="presentation" onclick="showAPIActionContent('inpcon')"><a href="#">Invoices per Contract</a></li>
            <li role="presentation" onclick="showAPIActionContent('infiles')"><a href="#">Invoices Files</a></li>
            <li role="presentation" onclick="showAPIActionContent('infdwn')"><a href="#">Invoices File Download</a></li>
            <li role="presentation" onclick="showAPIActionContent('geobfdwn')"><a href="#">Geobilling File Download</a></li>
            <li><h5>Notifications</h5></li>
            <li role="presentation" onclick="showAPIActionContent('noti')"><a href="#">Invoice Notifications</a></li>
            <li role="presentation" onclick="showAPIActionContent('noti_get')"><a href="#">Get a Notification</a></li>
            <li role="presentation" onclick="showAPIActionContent('noti_create')"><a href="#">Create a Notification</a></li>
            <li role="presentation" onclick="showAPIActionContent('noti_modify')"><a href="#">Modify a Notification</a></li>
            <li role="presentation" onclick="showAPIActionContent('noti_remove')"><a href="#">Remove a Notification</a></li>
          </ul>
        </div>

        <!-- API action content -->
        <div class="col-md-9">
          <div id="api_action_body_wrapper">

            <!-- Invoices per account -->
            <div id="inpacct" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">List Account's Invoices</label>
								<span class="help-block">For a given account, this lists available invoices for a specific month</span>
              </div>
              <div class="form-group">
								<label for="">Account ID</label>
								<span class="help-block">Identifies the account under which data is aggregated.</span>
                <input id="account_id" type="text" class="form-control" placeholder="B-C-1BBSI2F (Account ID)">
              </div>
              <div class="form-group">
								<label for="">Invoice Date</label>
								<span class="help-block">The year/month for which data is aggregated.</span>
                <div class="input-group date short">
                  <input type="text" class="form-control inpacct" value="">
                  <div class="input-group-addon">
                    <span class="glyphicon glyphicon-th"></span>
                  </div>
                </div>
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('inpacct')">
            </div>

            <!-- Invoices per contract -->
            <div id="inpcon" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">List Contract's Invoices</label>
								<span class="help-block">For a given contract, this lists available invoices for a specific month</span>
              </div>
              <div class="form-group">
								<label for="">Contract ID</label>
								<span class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="inpcon_contract_id" type="text" class="form-control" placeholder="C-1BBSI2U (Contract ID)">
              </div>
              <div class="form-group">
								<label for="">Invoice Date</label>
								<span class="help-block">The year/month for which data is aggregated.</span>
                <div class="input-group date short">
                  <input type="text" class="form-control inpcon" value="">
                  <div class="input-group-addon">
                    <span class="glyphicon glyphicon-th"></span>
                  </div>
                </div>
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('inpcon')">
            </div>

            <!-- Invoices file listing -->
            <div id="infiles" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">List Contract's Invoice Files</label>
								<span class="help-block">For a given contractâ€™s invoice, this lists available files, which often represent the same invoice data in different formats.</span>
              </div>
              <div class="form-group">
								<label for="">Contract ID</label>
								<span class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="infiles_contract_id" type="text" class="form-control" placeholder="C-1BBSI2U (Contract ID)">
              </div>
              <div class="form-group">
								<label for="">Invoice Number</label>
								<span class="help-block">Ientifies each unique invoice.</span>
                <input id="infiles_invoice_num" type="text" class="form-control" placeholder="16564000726 (Invoice Number)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('infiles')">
            </div>

            <!-- Invoices file download -->
            <div id="infdwn" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">Download an Invoice File</label>
								<span class="help-block">For a given contract's invoice file, this accesses the content of the file.</span>
              </div>
              <div class="form-group">
								<label for="">Contract ID</label>
								<span class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="infdwn_contract_id" type="text" class="form-control" placeholder="C-1BBSI2U (Contract ID)">
              </div>
              <div class="form-group">
								<label for="">Invoice Number</label>
								<span class="help-block">Identifies each unique invoice.</span>
                <input id="infdwn_invoice_num" type="text" class="form-control" placeholder="16564000726 (Invoice Number)">
              </div>
              <div class="form-group">
								<label for="">Invoice Filename</label>
								<span class="help-block">Identifies each invoice file.</span>
                <input id="infdwn_invoice_file" type="text" class="form-control" placeholder="KR_DSM_ACCOUNT_NAME_1-L80Z1P_3-14GPIAR_16564000726_FINAL_1.pdf (Invoice Filename)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('infdwn')">
            </div>

            <!-- Geobilling File Download -->
            <div id="geobfdwn" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">Download Geobilling Files</label>
								<span class="help-block">This provides details on invoicing for each geographic zone within the Akamai network.</span>
              </div>
              <div class="form-group">
								<label for="">Contract ID</label>
								<span class="help-block">Identifies the contract under which data is aggregated.</span>
                <input id="geobfdwn_contract_id" type="text" class="form-control" placeholder="C-1BBSI2U (Contract ID)">
              </div>
              <div class="form-group">
								<label for="">Product ID</label>
								<span class="help-block">Identifies the product under which data is aggregated.</span>
                <input id="geobfdwn_product_id" type="text" class="form-control" placeholder="M-LC-122937 (Product ID)">
              </div>
              <div class="form-group">
								<label for="">Date</label>
								<span class="help-block">The date for which data is aggregated.</span>
                <div class="input-group dateday short">
                  <input type="text" class="form-control geobfdwn" value="">
                  <div class="input-group-addon">
                    <span class="glyphicon glyphicon-th"></span>
                  </div>
                </div>
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('geobfdwn')">
            </div>

            <!-- Notifications -->
            <div id="noti" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">List Notifications</label>
								<span class="help-block">Notifications inform a set of users whenever there are changes to an invoice. This lists all available notifications.</span>
              </div>
              <div class="form-group">
								<label for="">Account ID</label>
                <span class="help-block">Identifies the account under which data is aggregated.</span>
                <input id="noti_account_id" type="text" class="form-control" placeholder="1-L80Z1P (Account ID)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('noti')">
            </div>

            <!-- Get a Notifications -->
            <div id="noti_get" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">Get a Notification</label>
								<span class="help-block">This accesses a specific notification, for example when making modifications to a specific notification.</span>
              </div>
              <div class="form-group">
								<label for="">Account ID</label>
                <span class="help-block">Identifies the account under which data is aggregated.</span>
                <input id="noti_get_account_id" type="text" class="form-control" placeholder="1-L80Z1P (Account ID)">
              </div>
              <div class="form-group">
								<label for="">Notification ID</label>
                <span class="help-block">Identifies each notification.</span>
                <input id="noti_get_notification_id" type="text" class="form-control" placeholder="4262 (Notification ID)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('noti_get')">
            </div>

            <!-- Create a Notifications -->
            <div id="noti_create" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">Create a Notification</label>
								<span class="help-block">This creates a new notification informing a set of users about invoices for a set of contracts. Each notification must specify a unique set of contracts.</span>
								<div id="textarea_wrapper" class="form-group has-feedback">
									<textarea id="noti_create_request_body" class="form-control" rows="15" placeholder="" onkeydown="validateJsonTextarea('textarea_wrapper', 'noti_create_request_body')"></textarea>
								</div>
								<input class="btn btn-success" type="button" value="Validate JSON" onclick="validateJsonTextarea('textarea_wrapper', 'noti_create_request_body')">
              </div>
              <div class="form-group">
								<label for="">Account ID</label>
                <span class="help-block">Identifies the account under which data is aggregated.</span>
                <input id="noti_create_account_id" type="text" class="form-control" placeholder="B-C-1BBSI2F (Account ID)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('noti_create')">
            </div>

            <!-- Modify a Notifications -->
            <div id="noti_modify" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">Modify a Notification</label>
								<span class="help-block">When modifying notifications, any read-only members retained from a GET operation are ignored on subsequent PUTs.</span>
								<div id="noti_modify_textarea_wrapper" class="form-group has-feedback">
									<textarea id="noti_modify_request_body" class="form-control" rows="15" placeholder="" onkeydown="validateJsonTextarea('noti_modify_textarea_wrapper', 'noti_modify_request_body')"></textarea>
								</div>
								<input class="btn btn-success" type="button" value="Validate JSON" onclick="validateJsonTextarea('noti_modify_textarea_wrapper', 'noti_modify_request_body')">
              </div>
              <div class="form-group">
								<label for="">Account ID</label>
                <span class="help-block">Identifies the account under which data is aggregated.</span>
                <input id="noti_modify_account_id" type="text" class="form-control" placeholder="B-C-1BBSI2F (Account ID)">
              </div>
              <div class="form-group">
								<label for="">Notification ID</label>
                <span class="help-block">Identifies each notification.</span>
                <input id="noti_modify_notification_id" type="text" class="form-control" placeholder="4262 (Notification ID)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('noti_modify')">
            </div>

            <!-- Remove a Notifications -->
            <div id="noti_remove" class="each_api_action" style="display: none">
              <div class="form-group">
								<label for="">Account ID</label>
                <span class="help-block">Identifies the account under which data is aggregated.</span>
                <input id="noti_remove_account_id" type="text" class="form-control" placeholder="B-C-1BBSI2F (Account ID)">
              </div>
              <div class="form-group">
								<label for="">Notification ID</label>
                <span class="help-block">Identifies each notification.</span>
                <input id="noti_remove_notification_id" type="text" class="form-control" placeholder="4262 (Notification ID)">
              </div>
              <input class="btn btn-primary" type="button" value="Send Request" onclick="runAPI('noti_remove')">
            </div>

            <!-- response -->
            <div id="api_response_wrapper" class="each_api_action top-buffer" style="display: none">
              <div id="loading_spinner" style="display: none"></div>
              <span id="api_response"></span>
            </div>

          </div> <!-- action body wrapper -->
        </div> <!-- API action content end -->
      </div> <!-- API content main body end -->

    </div> <!-- API section end -->

    <!-- Toke HTML column -->
    <div class="col-md-4 col-sm-offset-1">
      <div id="token_html"></div>
    </div>

  </div> <!-- end of main row -->
</div> <!-- container -->

<div id="footer_html"></div>

<script>
  $(document).ready(function() {
    loadTokenHtml();
    showAPIActionContent('inpacct');
		var placeholder = '{"title":"Billing Center Invoice Notification","status":"ACTIVE","emails":["user@example.com"],"contractIds":["C-1BBSI2U"]}';
		placeholder = JSON.stringify(JSON.parse(placeholder), null, 2);
		$("#noti_create_request_body").val(placeholder);
		$("#noti_modify_request_body").val(placeholder);

		$('.input-group.date input').each(function() {
			$(this).datepicker({
				format: "mm/yyyy",
				startView: "months",
				minViewMode: "months",
        endDate: '+0d',
        autoclose: true
			});
      $(this).datepicker('setDate', getFormattedDate(new Date()));
    });

		$('.input-group.dateday input').datepicker({
			endDate: '+0d',
			autoclose: true
		});
    $('.input-group.dateday input').datepicker('setDate', getFormattedDate(new Date()));

  });

  function runAPI(apitype) {
    if (apitype == "inpacct") {
      var account_id = $("#account_id").val();
      var selected_date = $('.input-group.date .inpacct').datepicker('getDate');
      if (account_id && selected_date) {
        var year = selected_date.getFullYear();
        var month = selected_date.getMonth() + 1;
        var endpoint = "/invoicing-api/v2/accounts/"+account_id+"/invoices?";
        endpoint += "year="+year+"&month="+month;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "inpcon") {
      var cid = $("#inpcon_contract_id").val();
      var selected_date = $('.input-group.date .inpcon').datepicker('getDate');
      if (cid && selected_date) {
        var year = selected_date.getFullYear();
        var month = selected_date.getMonth() + 1;
        var endpoint = "/invoicing-api/v2/contracts/"+cid+"/invoices?";
        endpoint += "year="+year+"&month="+month;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "infiles") {
      var cid = $("#infiles_contract_id").val();
      var invoice_num = $("#infiles_invoice_num").val();
      if (cid && invoice_num) {
				var endpoint = "/invoicing-api/v2/contracts/"+cid+"/invoices/"+invoice_num+"/files";
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "infdwn") {
      var cid = $("#infdwn_contract_id").val();
      var invoice_num = $("#infdwn_invoice_num").val();
      var filename = $("#infdwn_invoice_file").val();
      if (cid && invoice_num && filename) {
				var endpoint = "/invoicing-api/v2/contracts/"+cid+"/invoices/"+invoice_num+"/files/"+filename;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "geobfdwn") {
      var cid = $("#geobfdwn_contract_id").val();
      var pid = $("#geobfdwn_product_id").val();
      var selected_date = $('.input-group.dateday .geobfdwn').datepicker('getDate');
      if (cid && pid && selected_date) {
        var year = selected_date.getFullYear();
        var month = selected_date.getMonth() + 1;
        var day = selected_date.getDate();
				var endpoint = "/invoicing-api/v2/contracts/"+cid+"/products/"+pid+"/geo-billing-files";
	      endpoint += "?year="+year+"&month="+month+"&day="+day;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "noti") {
      var aid = $("#noti_account_id").val();
      if (aid) {
        var endpoint ="/invoicing-api/v2/accounts/"+aid+"/notifications"
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "noti_get") {
      var aid = $("#noti_get_account_id").val();
      var nid = $("#noti_get_notification_id").val();
      if (aid && nid) {
        var endpoint ="/invoicing-api/v2/accounts/"+aid+"/notifications/"+nid;
        sendAPIRequestGet(endpoint, "luna_token");
      } else {
        showNotification("Some of the required fields are missing. Please enter.");
      }
    }

    if (apitype == "noti_create") {
      var aid = $("#noti_create_account_id").val();
      var body = $("#noti_create_request_body").val();
      if (IsJsonString(body)) {
				if (aid) {
					var endpoint = "/invoicing-api/v2/accounts/"+aid+"/notifications";
					var return_response = sendAPIRequestPost(endpoint, "luna_token", body);
				} else {
					showNotification("Please enter account ID");
				}
      } else {
        showNotification("JSON is not in valid format");
      }
    }

    if (apitype == "noti_modify") {
      var aid = $("#noti_modify_account_id").val();
      var nid = $("#noti_modify_notification_id").val();
      var body = $("#noti_modify_request_body").val();
      if (IsJsonString(body)) {
				if (aid && nid) {
					var endpoint = "/invoicing-api/v2/accounts/"+aid+"/notifications/"+nid;
					var return_response = sendAPIRequestPut(endpoint, "luna_token", body);
				} else {
					showNotification("Please enter account ID and notification ID");
				}
      } else {
        showNotification("JSON is not in valid format");
      }
    }

    if (apitype == "noti_remove") {
      var aid = $("#noti_remove_account_id").val();
      var nid = $("#noti_remove_notification_id").val();
      if (nid) {
        var endpoint = "/invoicing-api/v2/accounts/"+aid+"/notifications/"+nid;
        var return_response = sendAPIRequestDelete(endpoint, "luna_token");
      } else {
        showNotification("Please enter notification ID");
      }
    }
  }
</script>
